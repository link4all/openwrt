!function(){function t(t,a){var t=t||1,a=a||8;$.post("/","app=notice&action=notice_count&per_page_records="+a,function(n){o=n,e(n,t)},"json"),$.post("/","app=notice&action=notice_get_page&page="+t+"&per_page_records="+a,function(e){c=e.result,n(c,t),Ha.setFooterPosition()},"json")}function e(e,n){var a,i;if($("#pager").empty(),!e.pages)return!1;1==n?(a="disabled",1==e.pages&&(i="disabled")):n==e.pages?i="disabled":(a="",i="");var o='<ul class="pagination"><li class="'+a+'" id="prev_btn"><a href="#"><span>«</span></a></li><li class="'+i+'" id="next_btn"><a href="#"><span>»</span></a></li></ul>';$("#pager").append(o),$("#prev_btn").click(function(){return 1!==n&&(t(n-1),void(n-=1))}),$("#next_btn").click(function(){return n!==e.pages&&(t(n+1),void(n+=1))});for(var c=1;c<=e.pages;c++){var s;s=c==n?"active":"";var d='<li class="'+s+' page_item"><a href="" id="pager_num_'+c+'">'+c+"</a></li>";$("#next_btn").before($(d)),function(e){$("#pager_num_"+e).click(function(){return e!==n&&(t(e),!1)}),Ha.setFooterPosition()}(c)}e.pages>=11&&(n<=6?$(".page_item").each(function(){var t=$(this).find("a").prop("id").split("_").pop();t>=12&&t<=e.pages-2&&$(this).addClass("hidden"),t==e.pages-1&&($(this).find("a").html("..."),$(this).addClass("disabled"))}):n>=e.pages-5?$(".page_item").each(function(){var t=$(this).find("a").prop("id").split("_").pop();2==t&&($(this).find("a").html("..."),$(this).addClass("disabled")),t>2&&t<e.pages-10&&$(this).addClass("hidden")}):$(".page_item").each(function(){var t=$(this).find("a").prop("id").split("_").pop();(t<=n-5||t>=n+5)&&(1==t||t==e.pages||(2==t||t==e.pages-1?($(this).find("a").html("..."),$(this).addClass("disabled")):$(this).addClass("hidden")))}))}function n(e,n){var n=n||1;if($("#notice_container").empty(),e){d=n,$("#notice_footer,#pager").removeClass("hidden");for(var i=0;i<e.length;i++){var o,c=e[i],s=formatTime(new Date(1e3*c.Time),"yyyy-MM-dd hh:mm");o="app"==c.Dest_type?"/?app="+c.Dest:c.Dest;var p;0==c.Ergen?p="text-success":1==c.Ergen?p="text-warning":c.Ergen>=2&&(p="text-danger");var r;r=0==c.Read?"unread":"";var l='<tr id="notice_'+c.Id+'" class="'+r+'"><td><div class="pull-left"><input type="checkbox" data-checked="'+c.Id+'">&nbsp;&nbsp;<span class="glyphicon glyphicon-info-sign '+p+'"></span></div></td><td class="text-left">'+s+'</td><td class="text-left read_notice" id="notice_desc_'+c.Id+'" data-toggle="modal" data-target="#myModal">'+c.Desc+'</td><td><div class="pull-left"><a href="'+o+'"><button id="deal_notice_'+c.Id+'" class="btn btn-xs btn-info">'+UI.Deal+'</button></a><button class="btn btn-xs btn-danger" id="delete_notice_'+c.Id+'">'+UI.Delete+"</button></div></td></tr>";$(l).appendTo($("#notice_container")),function(e,n,i){$("#delete_notice_"+e).click(function(){a(e,n)}),$("#notice_desc_"+e).click(function(){$("#single_notice").html("Loading...").attr("data-notice",e),$("#single_notice_content").html("Loading..."),$("#modal_deal_btn").parent().prop("href",i),$.post("/","app=notice&action=notice_get_a_notice&ids="+e,function(a){$("#single_notice").html(a.Desc).attr("data-notice",e),$("#single_notice_content").html(a.Detail),$.get("/?app=notice&action=mark_read_notice&ids="+e,function(e){e.status||t(n)},"json")},"json")}),$("#modal_deal_btn,#deal_notice_"+e).click(function(){$.get("/?app=notice&action=mark_read_notice&ids="+e,function(e){e.status||t(n)},"json")})}(c.Id,n,o)}Ha.mask.hide()}else{var _='<tr><td colspan="4">'+UI.Empty+"</td><tr>";$(_).appendTo($("#notice_container")),$("#notice_footer").addClass("hidden"),Ha.mask.hide()}}function a(e,n){$.get("/?app=notice&action=del_notice&ids="+e,function(e){Ha.showNotify(e),$.post("/","app=notice&action=notice_get_page&page="+n+"&per_page_records="+s,function(e){t(e.status?n-1:n)},"json")},"json")}function i(){var t=[];return $("tbody :checkbox").each(function(){if($(this).prop("checked")){var e=$(this).attr("data-checked");t.push(e)}}),t=t.join(",")}Ha.mask.show();var o,c,s=8,d=1;t(),$("#modal_delete_btn").click(function(){var t=$("#single_notice").attr("data-notice");a(t,d)}),$("#select_all_notice").click(function(){$("tbody :checkbox").prop("checked",$("#select_all_notice").prop("checked"))}),$("#delete_notices_btn").click(function(){var t=i();return!!t&&(a(t,d),void $("#select_all_notice").removeAttr("checked"))}),$("#markread_notices_btn").click(function(){var e=i();return!!e&&($.get("/?app=notice&action=mark_read_notice&ids="+e,function(e){e.status||t(d)},"json"),void $("#select_all_notice").removeAttr("checked"))})}();